# Footprinting Avançado

## Definição

**Footprinting** é coleta detalhada de informações sobre alvo antes de qualquer ataque.

---

## Fases do Footprinting

### 1. Reconhecimento Passivo
Coleta de informações SEM contato direto.

```
- Registros WHOIS
- Registros DNS
- Histórico (archive.org)
- Google dorks
- Redes sociais
- Repositórios públicos (GitHub)
```

### 2. Reconhecimento Ativo
Coleta COM contato direto (detectável).

```
- Varredura de portas (nmap)
- Banner grabbing
- Query DNS reverso
- Traceroute
- Ping
```

---

## Ferramentas e Técnicas

### Archive.org (Wayback Machine)

```
Verificar versões antigas do site:
https://web.archive.org/web/*/example.com

Técnicas:
- Procurar por endpoints antigos
- Descobrir tecnologias antigas
- Encontrar erros de configuração passados
```

### Google Dorking

Usar operadores avançados no Google:

```bash
# Arquivos específicos
site:example.com filetype:pdf

# Diretórios listados
site:example.com intitle:"index of"

# Emails de domínio
site:example.com "@example.com"

# Informações sensíveis
site:example.com password
site:example.com config
site:example.com admin

# Wordpress
site:example.com wp-admin

# Erros expostos
site:example.com error
site:example.com exception
```

### Mecanismos de Busca Especializados

```
Shodan: Busca IoT e dispositivos
  - busca por porta, banner, localização
  - shodan.io

Censys: Certificados, IPs, domínios
  - censys.io

VirusTotal: Reputação de IPs/domínios
  - virustotal.com

MXToolbox: Reputação de mail
  - mxtoolbox.com
```

### GitHub Dorking

Procurar por credenciais expostas:

```
site:github.com "example.com" password
site:github.com "example.com" api_key
site:github.com "example.com" secret
```

### Redes Sociais

```
- LinkedIn: Funcionários, títulos
- Twitter/X: Anúncios de tecnologia
- Facebook: Informações da empresa
- Instagram: Fotos internas
```

---

## Reconhecimento de Tecnologia

### Wappalyzer

Identifica tecnologias web usadas:

```bash
# Browser extension
# Instalar do Chrome/Firefox

# CLI
docker run --rm -v /tmp/wappalyzer:/app wappalyzer/cli:latest \
  https://example.com
```

### BuiltWith

```
https://builtwith.com/
- Histórico de tecnologias
- CDN usado
- Analytics
- Hospedagem
```

### SSL/TLS Certificate Analysis

```bash
# Informações de certificado
openssl s_client -connect example.com:443

# Listar certificados (com grep)
echo | openssl s_client -connect example.com:443 2>/dev/null | \
  openssl x509 -text -noout

# Examinar Subject Alternative Names (SANs)
openssl s_client -connect example.com:443 -showcerts 2>/dev/null | \
  grep "DNS:"
```

**Informações úteis**:
- Subdomínios (SANs)
- Organização
- Certificado autoassinado?
- Data de expiração
- CA issuer

---

## Mapeamento de Redes

### Traceroute

Descobrir caminho até o alvo:

```bash
traceroute example.com
traceroute -m 30 example.com      # Max hops
traceroute -I example.com         # ICMP
traceroute -T example.com         # TCP
```

### Whois de Blocos IP

```bash
whois 203.0.113.0/24
whois --country BR              # Por país
```

### CIDR Finder

```bash
whois example.com | grep -i cidr
```

---

## Enumeração de Email

### Padrões Comuns

```
firstname.lastname@company.com
firstname@company.com
flastname@company.com
first@company.com
l.lastname@company.com
```

### Ferramentas

```bash
# Verificar emails válidos
hunter.io

# Email patterns
clearbit.com

# Alternativa manual
# Usar LinkedIn + padrão
```

### Validação de Email

```bash
# SMTP check
python3 -m smtplib example.com
```

---

## Mapeamento de Serviços

### Banner Grabbing

```bash
# HTTP
curl -i https://example.com | head -20

# SSH
nc -v example.com 22

# FTP
nc -v example.com 21

# Telnet (protocolo antigo)
telnet example.com 23
```

### Nmap com Scripts

```bash
nmap -sV --script vuln example.com
nmap --script banner example.com
```

---

## Coleta de Dados de DNS

### DNS Fingerprinting

```bash
# Qual DNS usar
dig @8.8.8.8 example.com
dig @1.1.1.1 example.com

# DNSSEC
dig example.com +dnssec

# NS records completos
dig example.com NS

# SPF, DKIM, DMARC
dig example.com TXT
```

### Zone Transfer Attempt

```bash
# Tentar zone transfer
dig @ns1.example.com example.com axfr

# Com script
for ns in $(dig example.com NS +short); do
  echo "Tentando $ns:"
  dig @$ns example.com axfr
done
```

---

## Análise de Estrutura

### Mapa de Aplicação

```
Documentar:
- Entrada principal
- Subpáginas encontradas
- APIs expostas
- Admin panels
- CDN usado
- WAF presente
- Certificados
```

### Análise de Headers

```bash
curl -i https://example.com

Headers importante:
- Server: (versão)
- X-Powered-By: (tecnologia)
- X-Frame-Options: (clickjacking)
- Content-Security-Policy: (XSS)
- Strict-Transport-Security: (HTTPS)
```

---

## Footprinting Automation

### Script Bash Simples

```bash
#!/bin/bash
TARGET=$1

echo "[*] Footprinting para: $TARGET"

echo "[+] WHOIS..."
whois $TARGET

echo "[+] DNS Lookup..."
dig $TARGET ANY

echo "[+] Nmap Scan..."
nmap -sV $TARGET

echo "[+] SSL Certificate..."
echo | openssl s_client -connect $TARGET:443 2>/dev/null | \
  openssl x509 -text -noout

echo "[+] Concluído!"
```

### Ferramentas Integradas

```bash
# Recon-ng
recon-ng

# theHarvester
theharvester -d example.com -l 100 -b google

# Shodan CLI
shodan search "example.com"
```

---

## Checklist de Footprinting

```
Reconhecimento Passivo:
☐ WHOIS - Proprietário, contato
☐ DNS - Records, nameservers
☐ Archive.org - Versões antigas
☐ Google Dorking - Informações expostas
☐ GitHub Dorking - Código, credenciais
☐ LinkedIn - Funcionários, tecnologias
☐ Certificados SSL - SANs, organização
☐ Tecnologias - Stack de tecnologia

Reconhecimento Ativo:
☐ Nmap - Portas, serviços
☐ Banner Grabbing - Versões
☐ Traceroute - Caminho de rede
☐ DNS Transfer - Zone transfer
☐ Whois de IP - Blocos de rede
☐ Email Harvesting - Emails da empresa
☐ Headers HTTP - Configurações

Análise:
☐ Documentar descobertas
☐ Identificar tecnologias
☐ Mapear infraestrutura
☐ Priorizar alvos
☐ Planejar próximas fases
```

---

## Documento de Saída

Criar relatório com:

```
1. Executive Summary
2. Informações da Organização
3. Infraestrutura Técnica
4. Tecnologias Identificadas
5. Pontos de Contato
6. Achados Preliminares
7. Recomendações
```

---

Próximo: Varredura com `nikto.md` e `nessus.md`
