# Enumeração FTP

## Introdução

**FTP** (File Transfer Protocol) é protocolo antigo e frequentemente mal configurado.

## Conceitos

### Porta
- 21/TCP: FTP (sem criptografia)
- 990/TCP: FTPS (com SSL)

### Autenticação
- Anônima: user=anonymous, pass=email
- Autenticada: credenciais reais

---

## Ferramentas

### nmap

```bash
# Detectar FTP
nmap -p 21 target

# Script banner
nmap -p 21 --script ftp-banner target

# Enumeração completa
nmap -p 21 --script ftp-* target
```

### nc (netcat)

```bash
# Conectar
nc target 21

# Resultado
220 ftp.example.com FTP server (Version 6.4/OpenBSD...)
```

### ftp

```bash
# Cliente FTP
ftp target

# Conectar anônimo
> user
anonymous
> pass
(email qualquer)
```

### hydra

```bash
# Bruteforce
hydra -l admin -P wordlist.txt ftp://target
```

---

## Enumeração Passo a Passo

### 1. Detectar FTP

```bash
nmap -p 21 target

# Resultado: 21/tcp open ftp
```

### 2. Banner Grabbing

```bash
nc target 21

# Saída
220 ftp.example.com FTP server (Version 6.4/OpenBSD)
```

**Informações úteis**:
- Versão do servidor
- Sistema operacional
- Possíveis vulnerabilidades

### 3. Testar Acesso Anônimo

```bash
ftp target

Connected to 192.168.1.100
Name: anonymous
331 Please specify the password.
Password: (qualquer email)
230 Login successful
```

### 4. Listar Conteúdo

```bash
ftp> ls -la

-rw-r--r--  1 0  0       1234 Nov 25 10:00 file.txt
drwxr-xr-x  2 0  0       4096 Nov 25 10:00 uploads
drwxr-xr-x  2 0  0       4096 Nov 25 10:00 public
```

### 5. Explorar Diretórios

```bash
ftp> cd uploads
ftp> ls
ftp> get arquivo.txt
```

---

## Vulnerabilidades Comuns

### Anonymous FTP Habilitado

```bash
# Acesso sem credenciais
ftp target
user: anonymous
pass: (qualquer)
```

**Risco**: Exposição de dados sensíveis

### Configuração Fraca

```
- Sem restrição de diretório
- Sem validação de comando
- Sem logging
- Sem limite de conexão
```

### Versão Obsoleta

```bash
# ProFTPD, vsftpd, wu-ftpd antigos com vulnerabilidades
```

---

## Script de Enumeração

```bash
#!/bin/bash

TARGET=$1

echo "[*] Enumerando FTP em $TARGET"

echo "[+] Banner Grabbing..."
timeout 2 nc -v $TARGET 21 2>&1 | head -5

echo "[+] Tentando acesso anônimo..."
ftp -n $TARGET << EOF
user anonymous
pass anon@anon.com
ls -la
quit
EOF
```

---

## Acesso e Coleta de Dados

### Baixar Arquivos

```bash
ftp> mget *           # Baixa todos
ftp> mget *.txt       # Padrão
```

### Upload (Se Permitido)

```bash
ftp> put shell.php

# Resultado
229 Entering Extended Passive Mode
150 Here comes the directory listing
226 Transfer complete
```

---

## Métodos de Ataque

### Rainbow Tables

```bash
# Se conseguir arquivo com hashes
hashcat -m 3200 hashes.txt wordlist.txt
```

### Bruteforce de Credenciais

```bash
hydra -l admin -P rockyou.txt ftp://target -v
```

### Explorar Configuração

```bash
# Subir de privilégio se FTP rodar como root
```

---

## Checklist de Enumeração FTP

```
☐ Porta 21 aberta?
☐ Banner com versão
☐ Acesso anônimo habilitado?
☐ Diretórios listáveis?
☐ Dados sensíveis expostos?
☐ Upload permitido?
☐ Versão vulnerável?
☐ Logging habilitado?
```

---

Próximo: `ssh-enum.md`
