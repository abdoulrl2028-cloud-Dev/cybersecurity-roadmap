# Nessus — Scanner Profissional de Vulnerabilidades

## Introdução

**Nessus** é o scanner de vulnerabilidades mais popular da indústria, desenvolvido pela Tenable.

## Versões

### Nessus Essentials (Gratuito)
- Até 16 IPs
- Scans básicos
- Ideal para laboratório

### Nessus Professional (Pago)
- Ilimitado de IPs
- Compliance (PCI-DSS, HIPAA)
- Relatórios avançados

---

## Instalação

### Linux (Ubuntu/Debian)

```bash
# Baixar
wget https://www.tenable.com/downloads/nessus

# Instalar
sudo dpkg -i Nessus-10.x.x-debian6_amd64.deb

# Iniciar serviço
sudo systemctl start nessusd
sudo systemctl enable nessusd

# Acessar
# https://localhost:8834
```

### Kali Linux
```bash
sudo apt install nessus

sudo systemctl start nessusd

# URL padrão
# https://localhost:8834
```

---

## Configuração Inicial

### 1. Acessar Interface

```
https://localhost:8834
Usuário: admin
Senha: (criar na primeira vez)
```

### 2. Ativar Nessus

- Obter código de ativação (nessus.tenable.com)
- Registrar conta gratuita
- Copiar código
- Colar na interface

### 3. Atualizar Plugins

Processo automático, aguarde download dos plugins de vulnerabilidade.

---

## Criando um Scan

### 1. Nova Scan

```
Scans → Novo Scan → Escolher Template
```

### 2. Templates

- **Host Discovery**: Descoberta rápida
- **Basic Network Scan**: Scan padrão
- **Advanced Scan**: Configuração custom
- **Credentials Patch Audit**: Com credenciais
- **Internal PCI Network Scan**: Compliance

### 3. Configurar Scan

```
Configurações:
- Nome do scan
- Descrição
- Targets: IPs ou CIDR
- Schedule (executar no futuro)
- Credenciais (SSH, SMB)
- Plugin selection
```

### 4. Executar

```
Botão "Escanear"
```

---

## Análise de Resultados

### Severidade

| Nível | Cor | Descrição |
|-------|-----|-----------|
| Critical | Vermelho | Exploração muito fácil, impacto alto |
| High | Laranja | Exploit disponível, impacto significativo |
| Medium | Amarelo | Exploit possível, impacto moderado |
| Low | Azul | Informação útil, impacto baixo |
| Info | Cinza | Apenas informação |

### CVSS Score

Métrica de severidade padronizada (0-10).

```
0.0 - 3.9: Baixo
4.0 - 6.9: Médio
7.0 - 8.9: Alto
9.0 - 10.0: Crítico
```

---

## Exemplo de Vulnerabilidade

```
Vulnerability: Apache 2.4.1 - Denial of Service

CVSS Score: 7.8 (High)

Description: 
Apache versions before 2.4.3 are vulnerable to...

Impact:
Remote attackers could cause denial of service

Solution:
Upgrade to Apache 2.4.3 or later

References:
- CVE-2012-0031
- https://nvd.nist.gov/vuln/detail/CVE-2012-0031
```

---

## Scans com Credenciais

### Configurar SSH

```
Configurações do Scan:
  Credenciais → SSH
  Username: root
  Tipo de autenticação: Senha ou Chave privada
```

### Benefícios

- Detectar patches ausentes
- Verificar configurações de sistema
- Ler arquivos de configuração
- Validar permissões

---

## Relatórios

### Exportar

```
Scan → Download Report
Formatos:
- PDF
- HTML
- CSV
- NESSUS (formato nativo)
```

### Customizar Relatório

```
Executivo: Alto nível
Detalhado: Todas as vulnerabilidades
Compliance: Mapeado para padrões
Remediação: Passos para corrigi-las
```

---

## Agendamento de Scans

```
Scans → Editar
Schedule:
  - Nunca (manual)
  - Diariamente
  - Semanalmente
  - Mensalmente
```

---

## Compliance

### Padrões Suportados

- PCI-DSS v3.2.1
- HIPAA
- NIST Cybersecurity Framework
- CIS Benchmarks

### Generar Relatório de Compliance

```
Scans → Compliance
Escolher padrão
Gerar relatório com gaps e recomendações
```

---

## Limitações

- Licença gratuita limitada a 16 IPs
- Requer cadastro Tenable
- Performance em grandes ambientes
- Taxa de falsos positivos possível

---

Próximo: Enumeração de serviços com `smb-enum.md`
